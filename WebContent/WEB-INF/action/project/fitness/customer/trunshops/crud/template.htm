<!DOCTYPE html>
<html lang="zh-CN">
<head>
${inc:/action/project/fitness/home/pub}
<title>会员转店</title>
<link href="${def:context}/js/project/fitness/css/contract1.css" rel="stylesheet">
<style type="text/css">
.bg{
background: rgba(42, 48, 56, -1.2) !important
}
</style>
</head>
    <body style="font-size: 14px">
	<form id="ptrestForm" name="ptrestForm" class="form-horizontal" role="form" method="post">
		<input type="hidden" id="type" value="1" />
				<div class="am-tabs r-tab-container goodsSale">
					<div class="sec-1">
						<input type="text" name="custall" id="custall" title="会员编号/姓名/手机号" placeholder="会员编号/姓名/手机号" style="width: 160px;" />
						<input type="hidden" name="custcode" id="custcode" /> 
						<button type="button" id="querybtn">查询</button>
					</div>
					<div class="sec-2">
						<div class="sec-top">
							<label for="depot">通店：</label>
							<div class="my-selected" >
								<select id="org_id" name="org_id" style="display: none;">
									<org-rows>
										<option value="${fld:org_id}">${fld:org_name}</option>
									</org-rows>
								</select>
							</div>
							<label for="depot">转课教练：</label>
							<div class="my-selected" >
								<select id="turnclasspt" name="turnclasspt" style="display: none;">
									<option value="">全部教练</option>
									<pt-rows>
										<option value="${fld:userlogin}">${fld:name}</option>
									</pt-rows>
								</select>
							</div>
							<button type="button" id="trunbtn">转店</button>
						</div>
						<div class="sec-bottom r-tab-cout-3-b">
							<table>
								<thead>
									<tr>
										<th>序号</th>
										<th>卡号</th>
										<th>姓名</th>
										<th>手机号</th>
										<th>私教课总节数</th>
										<th>私教课剩余节数</th>
										<th>类型</th>
										<th>状态</th>
										<th>私教</th>
										<th>结束日期</th>
										<th>来源</th>
									</tr>
								</thead>
								<tbody id="ptrestlist">
								</tbody>
							</table>
						</div>
					</div>
					<div class="sec-4">
						<label>操作员：</label>
						<input type="text" value="${fld:staff_name}" readonly="readonly">
						<label>操作日期：</label>
						<input type="text" value="${def:date}" readonly="readonly">
					</div>
				</div>
     </form>
    </body>
<script type="text/javascript">
$(function(){
	//页面点击事件
	/* $(document).click(function(){ 
		$(".error").html("");
	});  */
	searchSelectInit($("#turnclasspt,#org_id"));
	setSelectValue($("#org_id"), "${def:org}");
	//查询会员
	$("#querybtn").click(function(){
		if($("#custall").val()==""){
			ccms.dialog.notice("请输入会员编号/姓名/手机号！", 2000);
			return false;
		}
		var custall=$("#custall").val();
		$("#type").val("1");
		if(custall!=""){
			ccms.dialog.open({url : "${def:context}/action/project/fitness/customer/trunshops/trunshop/crud?pickcustname="
					+custall+"&org_id=${def:org}&objid=custcode&objidtwo=custall&random_number="+Math.random()});
		}else{
			$("#ptrestlist").html("");
			$("#custcode").val("");
		}
	});
	//转店
	$("#savebtn").click(function(){
		var url = "${def:actionroot}/insert";
		ajaxCall(url,{
			method:"post",
			form:"ptrestForm",
			progress:true,
			dataType:"script",
			success:function(){	
				ccms.dialog.notice("成功！", 2000, function(){
					location.href=location.href;
				});
			}
		});
	});
	
	//通店选择查询教练等
	$("#org_id").change(function(){
		var url = "${def:actionroot}/queryorgpt?org_id="+$(this).val();
		ajaxCall(url,{
			method:"get",
			progress:true,
			dataType:"script",
			success:function(){	
				$("#newcustcode,#newcustname").val("");
			}
		});
	});
	
});
function pickcustCallback(){
	if($("#type").val()=="1"){
		var url = "${def:actionroot}/queryptrest?custcode="+$("#custcode").val();
		ajaxCall(url,{
			method:"get",
			progress:true,
			dataType:"script",
			success:function(){	
			}
		});
	}
}



</script>
</html>
